<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CA Air Guard | PT Pro 2026</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
            -webkit-appearance: none; 
            margin: 0; 
        }
        /* Custom styling for the range slider */
        .score-slider {
            -webkit-appearance: none;
            width: 100%;
            height: 8px;
            background: #f1f5f9;
            border-radius: 10px;
            outline: none;
        }
        .score-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 24px;
            height: 24px;
            background: #003087;
            border: 4px solid #FFD700;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        .score-slider::-webkit-slider-thumb:hover {
            transform: scale(1.1);
            box-shadow: 0 0 10px rgba(0, 48, 135, 0.2);
        }
    </style>
</head>
<body class="bg-slate-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- Icons (Inline SVGs) ---
        const Shield = ({ size = 24, className = "", fill = "none" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
        );
        const Activity = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="22 12 18 12 15 21 9 3 6 12 2 12"/></svg>
        );
        const Zap = ({ size = 24, className = "", fill = "none" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
        );
        const RotateCcw = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M1 4v6h6"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
        );
        const AlertTriangle = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
        );
        const Heart = ({ size = 24, className = "", fill = "none" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/></svg>
        );
        const Award = ({ size = 24, className = "", fill = "none" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill={fill} stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
        );
        const CheckCircle2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="m9 12 2 2 4-4"/></svg>
        );
        const Loader2 = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={`animate-spin ${className}`}><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
        );
        const Gauge = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m12 14 4-4"/><path d="M3.34 19a10 10 0 1 1 17.32 0"/></svg>
        );
        const TrendingUp = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><polyline points="23 6 13.5 15.5 8.5 10.5 1 18"/><polyline points="17 6 23 6 23 12"/></svg>
        );
        const Key = ({ size = 24, className = "" }) => (
            <svg width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="m21 2-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.778-7.778Zm0 0L15.5 7.5m0 0 3 3L22 7l-3-3y-3.5"/></svg>
        );

        const App = () => {
            const [scoringData, setScoringData] = useState(null);
            const [activeTab, setActiveTab] = useState('calc');
            const [loadingPlan, setLoadingPlan] = useState(false);
            const [errorMessage, setErrorMessage] = useState('');
            const [aiPlan, setAiPlan] = useState(null);
            const [planDays, setPlanDays] = useState(90);
            const [targetScore, setTargetScore] = useState(90);
            const [apiKey, setApiKey] = useState('');

            // Profile State
            const [profile, setProfile] = useState({ gender: 'male', ageGroup: '<25', height: 0, waist: 0 });
            const [exercises, setExercises] = useState({ cardio: 'run', strength: 'pushups', core: 'situps' });
            const [scores, setScores] = useState({ 
                cardioMin: '0', cardioSec: '0', hamrVal: 0,
                strengthVal: 0, hrVal: 0,
                coreVal: 0, plankMin: '0', plankSec: '0', crunchVal: 0
            });

            // --- Data Loading ---
            useEffect(() => {
                const loadData = async () => {
                    try {
                        const baseUrl = window.location.href.split('#')[0].split('?')[0];
                        const dataUrl = new URL('scoring-data.json', baseUrl).href;
                        const response = await fetch(dataUrl);
                        if (!response.ok) throw new Error(`HTTP ${response.status}`);
                        const data = await response.json();
                        setScoringData(data);
                    } catch (err) {
                        setErrorMessage("Data Sync Error: Ensure 'scoring-data.json' is in the same folder as index.html on GitHub.");
                        console.error(err);
                    }
                };
                loadData();
            }, []);

            // --- Calculation Logic ---
            const results = useMemo(() => {
                if (!scoringData) return { total: 0, ratio: 0, cardioPts: 0, whtrPts: 0, strengthPts: 0, corePts: 0, cardioFail: false, status: 'Loading...' };

                const userTable = scoringData.tables[profile.gender]?.[profile.ageGroup];
                if (!userTable) return { total: 0, ratio: 0, cardioPts: 0, whtrPts: 0, strengthPts: 0, corePts: 0, cardioFail: false, status: 'Profile Error' };

                const h = parseFloat(profile.height) || 1;
                const w = parseFloat(profile.waist) || 0;
                const ratio = parseFloat((w / h).toFixed(3));
                let whtrPts = 0;
                if (h > 0 && w > 0) {
                    for (const tier of scoringData.whtr) { if (ratio <= tier.max) { whtrPts = tier.pts; break; } }
                }

                let cardioPts = 0;
                if (exercises.cardio === 'run') {
                    const runSec = (parseInt(scores.cardioMin, 10) || 0) * 60 + (parseInt(scores.cardioSec, 10) || 0);
                    if (runSec > 0) {
                        for (const tier of userTable.cardio.run) { if (runSec <= tier.time) { cardioPts = tier.pts; break; } }
                    }
                } else {
                    const hamr = parseInt(scores.hamrVal, 10) || 0;
                    if (hamr > 0) {
                        for (const tier of userTable.cardio.hamr) { if (hamr >= tier.min) { cardioPts = tier.pts; break; } }
                    }
                }

                let strengthPts = 0;
                const sTable = exercises.strength === 'pushups' ? userTable.strength.pushups : userTable.strength.handRelease;
                const sVal = parseInt(exercises.strength === 'pushups' ? scores.strengthVal : scores.hrVal, 10) || 0;
                if (sVal > 0) {
                    for (const tier of sTable) { if (sVal >= tier.min) { strengthPts = tier.pts; break; } }
                }

                let corePts = 0;
                if (exercises.core === 'situps') {
                    const cVal = parseInt(scores.coreVal, 10) || 0;
                    if (cVal > 0) {
                        for (const tier of userTable.core.situps) { if (cVal >= tier.min) { corePts = tier.pts; break; } }
                    }
                } else if (exercises.core === 'crunch') {
                    const crVal = parseInt(scores.crunchVal, 10) || 0;
                    if (crVal > 0) {
                        for (const tier of userTable.core.crunch) { if (crVal >= tier.min) { corePts = tier.pts; break; } }
                    }
                } else {
                    const plankSec = (parseInt(scores.plankMin, 10) || 0) * 60 + (parseInt(scores.plankSec, 10) || 0);
                    if (plankSec > 0) {
                        for (const tier of userTable.core.plank) { if (plankSec >= tier.min) { corePts = tier.pts; break; } }
                    }
                }

                const total = cardioPts + whtrPts + strengthPts + corePts;
                const cardioFail = cardioPts < 29.5 && (parseInt(scores.cardioMin) > 0 || scores.hamrVal > 0);
                const status = (total >= 90 && !cardioFail) ? 'Excellent' : (total >= 75 && !cardioFail) ? 'Satisfactory' : 'Unsatisfactory';

                return { total: parseFloat(total.toFixed(1)), ratio, cardioPts, whtrPts, strengthPts, corePts, cardioFail, status };
            }, [profile, scores, exercises, scoringData]);

            // --- AI Roadmap Generation (Updated for GenAI.mil API) ---
            const callMilAiWithRetry = async (prompt, systemInstruction, retries = 0) => {
                const url = "https://api.genai.mil/v1/chat/completions";
                
                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: { 
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${apiKey}`
                        },
                        body: JSON.stringify({
                            model: "gemini-2.5-pro",
                            messages: [
                                { role: "system", content: systemInstruction + " IMPORTANT: Output ONLY valid JSON in the requested format." },
                                { role: "user", content: prompt }
                            ],
                            response_format: { type: "json_object" }
                        })
                    });

                    if (!response.ok) {
                        const errorText = await response.text();
                        throw new Error(`API Error ${response.status}: ${errorText}`);
                    }
                    
                    const data = await response.json();
                    const content = data.choices[0].message.content;
                    return JSON.parse(content);
                } catch (error) {
                    if (retries < 3) {
                        const delay = Math.pow(2, retries) * 1000;
                        await new Promise(res => setTimeout(res, delay));
                        return callMilAiWithRetry(prompt, systemInstruction, retries + 1);
                    }
                    throw error;
                }
            };

            const generateAIPlan = async () => {
                if (!apiKey) {
                    setErrorMessage("API Key Required: Please enter your GenAI.mil STARK key below.");
                    return;
                }
                
                setLoadingPlan(true);
                setErrorMessage('');
                
                const systemPrompt = `You are an elite Human Performance Specialist for the CA Air National Guard. 
                Generate a periodized training roadmap as a JSON object with the following keys:
                - focus: (string) overall theme
                - nutrition: (array of strings) 3 tactical tips
                - phases: (array of 3 objects) Each phase has 'title', 'description', and 'weeklyRoutine' (object with Mon-Sun keys).
                Target score is ${targetScore}.`;

                const userPrompt = `Member: ${profile.gender}, Age Group: ${profile.ageGroup}. Current composite score: ${results.total}/100. Cardio: ${results.cardioPts}, Strength: ${results.strengthPts}, Core: ${results.corePts}. Height: ${profile.height}in, Waist: ${profile.waist}in. Objective: Reach ${targetScore} points within ${planDays} days.`;

                try {
                    const plan = await callMilAiWithRetry(userPrompt, systemPrompt);
                    setAiPlan(plan);
                    setActiveTab('plan');
                } catch (e) {
                    setErrorMessage("GenAI.mil Hub sync failed. Please check your API Key and network connection.");
                    console.error(e);
                } finally {
                    setLoadingPlan(false);
                }
            };

            if (!scoringData && !errorMessage) {
                return (
                    <div className="min-h-screen flex items-center justify-center bg-slate-50 flex-col gap-4">
                        <Loader2 size={48} className="text-[#003087]" />
                        <p className="text-xs font-black uppercase text-slate-400 tracking-widest">Loading Scoring Tables...</p>
                    </div>
                );
            }

            return (
                <div className="min-h-screen pb-24">
                    <header className="bg-[#003087] border-b-4 border-[#FFD700] sticky top-0 z-50 px-6 h-20 flex items-center justify-between shadow-lg">
                        <div className="flex items-center gap-4">
                            <div className="bg-white p-1.5 rounded-lg shadow-sm">
                                <Shield className="text-[#003087] w-7 h-7" fill="#003087" />
                            </div>
                            <div>
                                <h1 className="text-white font-black text-xl md:text-2xl tracking-tighter leading-none">
                                    CALIFORNIA <span className="text-[#FFD700]">AIR GUARD</span>
                                </h1>
                                <p className="text-[10px] text-white/60 font-bold uppercase tracking-[0.2em] mt-1">Human Performance Portal</p>
                            </div>
                        </div>
                        <button onClick={() => window.location.reload()} className="text-white/40 hover:text-[#FFD700] p-2 transition-colors">
                            <RotateCcw size={22} />
                        </button>
                    </header>

                    <main className="max-w-6xl mx-auto p-4 md:p-10 space-y-8">
                        {errorMessage && (
                            <div className="bg-rose-50 border-2 border-rose-200 p-6 rounded-[2rem] flex items-center gap-4 text-rose-700">
                                <AlertTriangle size={32} />
                                <div>
                                    <p className="font-black uppercase text-xs tracking-widest">System Message</p>
                                    <p className="text-sm font-semibold opacity-80">{errorMessage}</p>
                                </div>
                            </div>
                        )}

                        <div className="grid grid-cols-2 bg-white rounded-2xl shadow-sm border border-slate-200 p-1.5 max-w-lg mx-auto">
                            <button onClick={() => setActiveTab('calc')} className={`flex items-center justify-center gap-2 py-3.5 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${activeTab === 'calc' ? 'bg-[#003087] text-white shadow-md' : 'text-slate-400 hover:text-slate-600'}`}>
                                <Activity size={16} /> Score Tool
                            </button>
                            <button onClick={() => setActiveTab('plan')} className={`flex items-center justify-center gap-2 py-3.5 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${activeTab === 'plan' ? 'bg-[#003087] text-white shadow-md' : 'text-slate-400 hover:text-slate-600'}`}>
                                <TrendingUp size={16} /> Training Plan
                            </button>
                        </div>

                        {activeTab === 'calc' ? (
                            <div className="grid lg:grid-cols-12 gap-8 items-start">
                                <div className="lg:col-span-7 space-y-8">
                                    <section className="bg-white rounded-[2.5rem] border border-slate-200 shadow-sm overflow-hidden">
                                        <div className="px-8 py-5 border-b border-slate-50 flex items-center gap-3 bg-slate-50/30">
                                            <div className="w-1.5 h-5 bg-[#FFD700] rounded-full"></div>
                                            <h2 className="text-xs font-black uppercase tracking-widest text-slate-700">1. About you</h2>
                                        </div>
                                        <div className="p-8 grid sm:grid-cols-2 gap-8">
                                            <div className="space-y-3">
                                                <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Gender</label>
                                                <div className="flex bg-slate-100 p-1 rounded-xl">
                                                    {['male', 'female'].map(g => (
                                                        <button key={g} onClick={() => setProfile({...profile, gender: g})} className={`flex-1 py-2.5 rounded-lg text-[10px] font-black uppercase transition-all ${profile.gender === g ? 'bg-white text-[#003087] shadow-sm' : 'text-slate-500'}`}>{g}</button>
                                                    ))}
                                                </div>
                                            </div>
                                            <div className="space-y-3">
                                                <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Age Bracket</label>
                                                <select className="w-full bg-slate-100 p-3.5 rounded-xl text-sm font-bold border-none outline-none focus:ring-2 focus:ring-[#003087]/20" value={profile.ageGroup} onChange={e => setProfile({...profile, ageGroup: e.target.value})}>
                                                    {scoringData?.ageGroups.map(a => <option key={a} value={a}>{a} Years</option>)}
                                                </select>
                                            </div>
                                            <div className="space-y-3">
                                                <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Height (Inches)</label>
                                                <input type="number" className="w-full bg-slate-100 p-4 rounded-xl text-lg font-bold border-none outline-none" value={profile.height || ''} placeholder="0" onChange={e => setProfile({...profile, height: e.target.value === '' ? 0 : parseInt(e.target.value)})} />
                                            </div>
                                            <div className="space-y-3">
                                                <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest ml-1">Waist (Inches)</label>
                                                <input type="number" className="w-full bg-slate-100 p-4 rounded-xl text-lg font-bold border-none outline-none" value={profile.waist || ''} placeholder="0" onChange={e => setProfile({...profile, waist: e.target.value === '' ? 0 : parseInt(e.target.value)})} />
                                            </div>
                                        </div>
                                    </section>

                                    <section className="bg-white rounded-[2rem] border border-slate-200 shadow-sm overflow-hidden">
                                        <div className="px-8 py-5 border-b border-slate-100 flex items-center gap-3 bg-slate-50/30">
                                            <div className="w-2 h-6 bg-[#003087] rounded-full"></div>
                                            <h2 className="text-xs font-black uppercase tracking-widest text-slate-700">2. Component results</h2>
                                        </div>
                                        <div className="p-8 space-y-10">
                                            <div className="space-y-5">
                                                <div className="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                                                    <div className="flex items-center gap-2 text-[#003087]">
                                                        <Heart size={18} fill="#003087" className="opacity-20" />
                                                        <span className="text-xs font-black uppercase tracking-widest">Aerobic Performance</span>
                                                    </div>
                                                    <div className="flex bg-slate-100 p-1 rounded-xl">
                                                        {['run', 'hamr'].map(opt => (<button key={opt} onClick={() => setExercises({...exercises, cardio: opt})} className={`px-5 py-2 rounded-lg text-[10px] font-black uppercase transition-all ${exercises.cardio === opt ? 'bg-white text-[#003087] shadow-sm' : 'text-slate-400'}`}>{opt === 'run' ? '2-Mile Run' : 'HAMR Shuttle'}</button>))}
                                                    </div>
                                                </div>
                                                <div className="bg-slate-50 p-6 rounded-3xl border border-slate-100">
                                                    {exercises.cardio === 'run' ? (
                                                        <div className="flex items-center justify-center gap-4">
                                                            <div className="text-center"><input type="number" placeholder="MM" className="w-20 p-4 rounded-xl text-3xl font-black text-center border-none shadow-sm" value={scores.cardioMin || ''} onChange={e => setScores({...scores, cardioMin: e.target.value})} /><span className="block text-[8px] font-black text-slate-400 uppercase mt-1">MIN</span></div>
                                                            <span className="text-3xl font-black text-slate-300">:</span>
                                                            <div className="text-center"><input type="number" placeholder="SS" className="w-20 p-4 rounded-xl text-3xl font-black text-center border-none shadow-sm" value={scores.cardioSec || ''} onChange={e => setScores({...scores, cardioSec: e.target.value})} /><span className="block text-[8px] font-black text-slate-400 uppercase mt-1">SEC</span></div>
                                                        </div>
                                                    ) : (
                                                        <div className="text-center"><input type="number" className="w-32 p-6 rounded-xl text-5xl font-black text-center border-none shadow-sm" value={scores.hamrVal || ''} placeholder="0" onChange={e => setScores({...scores, hamrVal: e.target.value === '' ? 0 : parseInt(e.target.value)})} /><span className="block text-[9px] font-black text-slate-400 uppercase tracking-widest mt-2">Shuttles</span></div>
                                                    )}
                                                    {results.cardioFail && <div className="mt-4 flex items-center justify-center gap-2 text-rose-500 bg-rose-50 p-3 rounded-xl border border-rose-100 text-[10px] font-black uppercase"><AlertTriangle size={14} /> Below Minimum Performance</div>}
                                                </div>
                                            </div>

                                            <div className="grid sm:grid-cols-2 gap-8">
                                                <div className="space-y-4">
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-[10px] font-black text-slate-500 uppercase tracking-widest">Strength Component</span>
                                                        <div className="flex bg-slate-100 p-1 rounded-lg">
                                                            {['pushups', 'handRelease'].map(opt => (<button key={opt} onClick={() => setExercises({...exercises, strength: opt})} className={`px-3 py-1.5 rounded-md text-[8px] font-black uppercase transition-all ${exercises.strength === opt ? 'bg-white text-[#003087] shadow-sm' : 'text-slate-400'}`}>{opt === 'pushups' ? 'Std' : 'H-Rel'}</button>))}
                                                        </div>
                                                    </div>
                                                    <div className="relative">
                                                        <input type="number" className="w-full bg-slate-50 p-8 rounded-3xl text-4xl font-black text-center border-none" value={exercises.strength === 'pushups' ? (scores.strengthVal || '') : (scores.hrVal || '')} placeholder="0" onChange={e => setScores({...scores, [exercises.strength === 'pushups' ? 'strengthVal' : 'hrVal']: e.target.value === '' ? 0 : parseInt(e.target.value)})} />
                                                        <span className="absolute bottom-3 left-0 right-0 text-center text-[8px] font-black text-slate-300 uppercase tracking-widest">Total Reps</span>
                                                    </div>
                                                </div>
                                                <div className="space-y-4">
                                                    <div className="flex items-center justify-between">
                                                        <span className="text-[10px] font-black text-slate-500 uppercase tracking-widest">Core Stability</span>
                                                        <div className="flex bg-slate-100 p-1 rounded-lg">
                                                            {['situps', 'plank', 'crunch'].map(opt => (<button key={opt} onClick={() => setExercises({...exercises, core: opt})} className={`px-2 py-1.5 rounded-md text-[8px] font-black uppercase transition-all ${exercises.core === opt ? 'bg-white text-[#003087] shadow-sm' : 'text-slate-400'}`}>{opt}</button>))}
                                                        </div>
                                                    </div>
                                                    {exercises.core === 'plank' ? (
                                                        <div className="grid grid-cols-2 gap-3">
                                                            <div className="relative"><input type="number" className="w-full bg-slate-50 p-6 rounded-2xl text-2xl font-black text-center border-none" value={scores.plankMin || ''} placeholder="M" onChange={e => setScores({...scores, plankMin: e.target.value})} /><span className="absolute bottom-2 left-0 right-0 text-center text-[7px] font-bold text-slate-300">MIN</span></div>
                                                            <div className="relative"><input type="number" className="w-full bg-slate-50 p-6 rounded-2xl text-2xl font-black text-center border-none" value={scores.plankSec || ''} placeholder="S" onChange={e => setScores({...scores, plankSec: e.target.value})} /><span className="absolute bottom-2 left-0 right-0 text-center text-[7px] font-bold text-slate-300">SEC</span></div>
                                                        </div>
                                                    ) : (
                                                        <div className="relative">
                                                            <input type="number" className="w-full bg-slate-50 p-8 rounded-3xl text-4xl font-black text-center border-none" value={exercises.core === 'situps' ? (scores.coreVal || '') : (scores.crunchVal || '')} placeholder="0" onChange={e => setScores({...scores, [exercises.core === 'situps' ? 'coreVal' : 'crunchVal']: e.target.value === '' ? 0 : parseInt(e.target.value)})} />
                                                            <span className="absolute bottom-3 left-0 right-0 text-center text-[8px] font-black text-slate-300 uppercase tracking-widest">Result</span>
                                                        </div>
                                                    )}
                                                </div>
                                            </div>
                                        </div>
                                    </section>
                                </div>

                                <div className="lg:col-span-5 space-y-8 sticky top-24">
                                    <div className={`p-10 rounded-[3rem] text-white shadow-2xl relative overflow-hidden transition-all duration-700 ${results.status === 'Excellent' ? 'bg-[#10B981]' : results.status === 'Satisfactory' ? 'bg-[#003087]' : 'bg-[#EF4444]'}`}>
                                        <div className="absolute -top-12 -right-12 opacity-10"><Shield size={240} strokeWidth={1} /></div>
                                        <div className="relative z-10 text-center pb-8 border-b border-white/20">
                                            <span className="text-[11px] font-black uppercase tracking-[0.4em] opacity-80">Composite Readiness</span>
                                            <h3 className="text-[10rem] font-black leading-none my-3 tabular-nums drop-shadow-xl">{results.total}</h3>
                                            <div className="inline-flex items-center gap-3 bg-white text-slate-900 px-8 py-3 rounded-full font-black text-sm uppercase tracking-widest shadow-xl">
                                                {results.status === 'Unsatisfactory' ? <AlertTriangle size={18} className="text-rose-500" /> : <Award size={18} className="text-yellow-500" fill="#EAB308" />}
                                                {results.status}
                                            </div>
                                        </div>
                                        <div className="mt-10 space-y-6">
                                            {[{l: 'Aerobic', v: results.cardioPts, m: 50}, {l: 'Body Comp', v: results.whtrPts, m: 20}, {l: 'Strength', v: results.strengthPts, m: 15}, {l: 'Core', v: results.corePts, m: 15}].map(s => (
                                                <div key={s.l} className="space-y-2">
                                                    <div className="flex justify-between text-[10px] font-black uppercase tracking-widest px-1">
                                                        <span className="opacity-70">{s.l}</span>
                                                        <span>{s.v.toFixed(1)} / {s.m}</span>
                                                    </div>
                                                    <div className="h-2.5 bg-black/20 rounded-full overflow-hidden border border-white/5">
                                                        <div className="h-full bg-yellow-400 transition-all duration-1000 ease-out" style={{ width: `${(s.v / s.m) * 100}%` }}></div>
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>

                                    <div className="bg-white p-10 rounded-[3rem] border border-slate-200 shadow-sm space-y-8 text-center">
                                        <div className="space-y-2 text-left border-b border-slate-100 pb-4">
                                            <h3 className="text-sm font-black uppercase tracking-widest text-slate-700 flex items-center gap-2"><Key size={16} className="text-[#003087]" /> Setup GenAI.mil Key</h3>
                                            <p className="text-[10px] text-slate-400 font-medium">Authentication required for roadmap generation</p>
                                            <div className="mt-3">
                                                <input 
                                                    type="password" 
                                                    placeholder="STARK XXXXX..." 
                                                    value={apiKey}
                                                    onChange={(e) => setApiKey(e.target.value)}
                                                    className="w-full bg-slate-50 border border-slate-200 p-3 rounded-xl text-xs font-mono focus:ring-2 focus:ring-[#003087]/20 outline-none transition-all"
                                                />
                                            </div>
                                        </div>

                                        <div className="space-y-6 px-2">
                                            <div className="flex justify-between items-end">
                                                <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest">Target Score</label>
                                                <span className="text-3xl font-black text-[#003087] leading-none">{targetScore}</span>
                                            </div>
                                            <input 
                                                type="range" 
                                                min="75" 
                                                max="100" 
                                                step="1"
                                                value={targetScore} 
                                                onChange={(e) => setTargetScore(parseInt(e.target.value))}
                                                className="score-slider"
                                            />
                                            <div className="flex justify-between text-[8px] font-black text-slate-300 uppercase tracking-tighter">
                                                <span>Minimum Pass (75)</span>
                                                <span>Excellence (90+)</span>
                                                <span>Perfect (100)</span>
                                            </div>
                                        </div>

                                        <div className="space-y-3">
                                            <label className="text-[10px] font-black text-slate-400 uppercase tracking-widest block text-left ml-1">Training Duration</label>
                                            <div className="flex justify-center gap-3">
                                                {[30, 60, 90, 180].map(d => (
                                                    <button key={d} onClick={() => setPlanDays(d)} className={`w-14 h-14 rounded-full text-[10px] font-black transition-all border-2 ${planDays === d ? 'bg-[#003087] text-white border-[#003087]' : 'border-slate-100 text-slate-400'}`}>{d}D</button>
                                                ))}
                                            </div>
                                        </div>

                                        <button 
                                            onClick={generateAIPlan} 
                                            disabled={loadingPlan} 
                                            className={`w-full text-white py-8 rounded-full font-black text-xs uppercase tracking-[0.4em] flex items-center justify-center gap-4 hover:shadow-2xl transition-all disabled:opacity-50 ${!apiKey ? 'bg-slate-400 cursor-not-allowed' : 'bg-[#003087]'}`}
                                        >
                                            {loadingPlan ? <Loader2 size={24} /> : <Zap size={24} className="fill-yellow-400 text-yellow-400" />} 
                                            Generate Roadmap
                                        </button>
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div className="max-w-4xl mx-auto space-y-10 animate-in fade-in duration-1000">
                                {!aiPlan ? (
                                    <div className="py-40 text-center border-4 border-dashed border-slate-200 rounded-[4rem] bg-white flex flex-col items-center">
                                        <div className="bg-slate-50 p-12 rounded-full mb-8"><Zap className="text-slate-200" size={80} /></div>
                                        <h3 className="text-xl font-black text-slate-300 uppercase tracking-widest">No Active Roadmap</h3>
                                        <button onClick={() => setActiveTab('calc')} className="mt-8 text-[#003087] font-black uppercase text-xs tracking-widest px-8 py-4 bg-white border border-slate-200 rounded-2xl">Return to Calculator</button>
                                    </div>
                                ) : (
                                    <div className="space-y-10 pb-20">
                                        <div className="bg-[#003087] text-white p-12 md:p-16 rounded-[4rem] shadow-2xl relative overflow-hidden border-b-8 border-[#FFD700]">
                                            <div className="relative z-10 flex flex-col md:flex-row justify-between items-start md:items-center gap-10 border-b border-white/10 pb-12 mb-12">
                                                <div>
                                                    <h2 className="text-6xl font-black mb-3 tracking-tighter text-[#FFD700]">{planDays}-Day Strategy</h2>
                                                    <div className="inline-flex items-center gap-3 bg-white/10 px-6 py-2.5 rounded-full border border-white/10 font-black uppercase text-xs tracking-widest">Target Objective: {targetScore} Pts</div>
                                                </div>
                                                <div className="max-w-md md:text-right">
                                                    <p className="text-[#FFD700] font-black uppercase text-[10px] tracking-[0.4em] mb-3">Strategic Focus</p>
                                                    <p className="text-2xl font-black uppercase tracking-tight opacity-90 underline decoration-[#FFD700] underline-offset-8 decoration-4">{aiPlan.focus}</p>
                                                </div>
                                            </div>
                                            <div className="grid md:grid-cols-3 gap-6 relative z-10">
                                                {aiPlan.nutrition.map((n, i) => (<div key={i} className="bg-white/5 p-6 rounded-[2.5rem] border border-white/10 text-xs font-bold flex gap-4 backdrop-blur-md"><CheckCircle2 className="text-[#FFD700] shrink-0 mt-0.5" size={20} /><span className="opacity-80 leading-relaxed uppercase tracking-tight">{n}</span></div>))}
                                            </div>
                                        </div>
                                        <div className="space-y-10">
                                            {aiPlan.phases.map((p, i) => (
                                                <div key={i} className="bg-white rounded-[3.5rem] border border-slate-200 overflow-hidden shadow-sm hover:shadow-xl transition-all">
                                                    <div className="bg-slate-50 p-10 border-b flex flex-col sm:flex-row justify-between items-start sm:items-center gap-6">
                                                        <div><span className="text-[9px] font-black text-[#003087] uppercase tracking-[0.3em] block mb-2 px-3 py-1.5 bg-[#003087]/5 rounded-full inline-block">Macrocycle {i+1}</span><h3 className="font-black text-3xl uppercase tracking-tighter text-slate-800">{p.title}</h3></div>
                                                        <Gauge size={32} className="text-slate-200" />
                                                    </div>
                                                    <div className="p-10 bg-[#003087]/5 text-sm font-bold text-slate-600 italic border-b border-blue-100/50">"{p.description}"</div>
                                                    <div className="divide-y divide-slate-100">
                                                        {Object.entries(p.weeklyRoutine).map(([d, r]) => (
                                                            <div key={d} className="p-8 flex flex-col sm:flex-row gap-6 sm:gap-20 text-sm hover:bg-slate-50 transition-colors group">
                                                                <div className="w-24 shrink-0"><span className="font-black text-[#003087] uppercase tracking-[0.2em] block mb-2">{d}</span><div className="w-8 h-1.5 bg-[#FFD700] rounded-full"></div></div>
                                                                <span className="text-slate-700 font-bold text-base leading-relaxed flex-1">{r}</span>
                                                            </div>
                                                        ))}
                                                    </div>
                                                </div>
                                            ))}
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}
                    </main>

                    <footer className="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-md border-t-2 border-slate-200 py-4 text-center z-50 shadow-2xl">
                        <div className="flex items-center justify-center gap-8">
                            <p className="text-[9px] font-black uppercase tracking-[0.3em] flex items-center gap-2 text-slate-500"><CheckCircle2 size={14} className="text-emerald-500" /> Verified Scoring</p>
                            <div className="w-[1px] h-4 bg-slate-200"></div>
                            <p className="text-[9px] font-black uppercase tracking-[0.3em] flex items-center gap-2 text-slate-500"><Shield size={14} className="text-[#003087]" /> Air Guard Ready</p>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
